{% extends 'forum/base_forum.html'%}

{% load static %}

{% block breadcrumb %}
    <li class="breadcrumb-item">
        <a href="{% url 'boards' %}">
            Boards
        </a>
    </li>
    <li class="breadcrumb-item">
        <a href="{{ topic.board.get_absolute_url }}">
           {{ topic.board.name }}
        </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">
           {{ topic.name }}
    </li>
{% endblock %}

{% block content %}
{% for post in topic.posts.all %}
<div class="card mb-2 {% if forloop.first %} border-dark {% endif %}">
    {% if forloop.first %}
        <div class="card-header text-white bg-dark py-2 px-3">{{ topic.name }}</div>
    {% endif %}
        <div class="row">
            <div class="col-2">
                <img src="{% static 'img/empty-avatar.png' %}" alt="{{ post.created_by.username }}" class="w-100">
                <small style="justify-content: center; display:grid;">Posts: {{ post.created_by.posts.count }}</small>
            </div>
            <div class="col-10">
                <div class="row mb-3">
                    <div class="col-6">
                        <strong class="text-muted">{{ post.created_by.username }}</strong>
                    </div>
                    <div class="col-6 text-right">
                        {% if post.updated_at %}
                            <small class="text-muted">Edited {{ post.updated_at }}</small>
                        {% else %}
                            <small class="text-muted">{{ post.created_at }}</small>
                        {% endif %}
                    </div>
                </div>
                {{ post.message }}
                <div class="mt-3">
                    <a href="{{ post.get_edit_url }}"
                       class="btn btn-primary btn-sm"
                       role="button">Edit</a>
                </div>
            </div>
        </div>
    </div>
{% endfor %}

<div class="mb-4">
    <a href="{% url 'reply_post' topic.board.slug topic.slug %}" class="btn btn-primary" role="button">Reply</a>
</div>

{% endblock%}